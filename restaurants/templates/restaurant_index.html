{% extends "base.html" %}
{% load static %}
{% block page_content %}
  <body>
    <div class="row">
      <div class="col-sm">
        <form method="GET" action="{% url 'search' %}">
          <div class="input-group">
            <input class="form-control"
                   type="search"
                   name="search"
                   placeholder="Craving a good slice?">
            <div class="input-group-append">
              <button class="btn btn-primary" type="submit">Search</button>
            </div>
          </div>
        </form>
        <div class="row row-cols-1 row-cols-md-3">
          {% if all_search_results %}
            {% for restaurant in all_search_results %}
              <div class="col mb-3">
                <div class="card" style="width: 12.3rem;">
                  <a href="{% url 'restaurant_detail' restaurant.pk %}">
                    {% if restaurant.image.url %}
                      <img class="card-img-top"
                           src="{{ restaurant.image.url }}"
                           alt="restaurant image">
                    {% else %}
                      <img class="card-img-top" src="{% static 'frank.jpg' %}" alt="My image">
                    {% endif %}
                    <div class="card-body">
                      <h5 class="card-title text-center overflow-hidden" style="height: 22px;">{{ restaurant.name|title }}</h5>
                      <p class="card-text text-justify overflow-hidden"
                         style="height: 5rem;
                                font-size:12px">{{ restaurant.description|title }}</p>
                    </div>
                  </a>
                </div>
              </div>
            {% endfor %}
          {% else %}
            {% for restaurant in restaurants %}
              <div class="col mb-3">
                <div class="card" style="width: 12rem;">
                  <a href="{% url 'restaurant_detail' restaurant.pk %}">
                    {% if restaurant.image.url %}
                      <img class="card-img-top"
                           src="{{ restaurant.image.url }}"
                           alt="restaurant image">
                    {% else %}
                      <img class="card-img-top" src="{% static 'frank.jpg' %}" alt="My image">
                    {% endif %}
                    <div class="card-body">
                      <h5 class="card-title text-center overflow-hidden" style="height: 22px;">{{ restaurant.name|title }}</h5>
                      <p class="card-text text-justify overflow-hidden"
                         style="height: 5rem;
                                font-size:12px">{{ restaurant.description|title }}</p>
                    </div>
                  </a>
                </div>
              </div>
            {% endfor %}
          {% endif %}
        </div>
        <div class="text-center mt-4">
          {% if user.is_authenticated %}
            <a href="{% url 'restaurant_create' %}" class="btn btn-secondary">Add a restaurant</a>
          {% else %}
            <p>
              <a href="{% url 'register' %}">Sign up</a> or <a href="{% url 'login' %}">Sign in</a>
              to create a restaurant!
            </p>
          {% endif %}
        </div>
      </div>
      {% comment %} </div> {% endcomment %}
      <div class="col-sm">
        <div id="map"
             style="height:100vh"
             class="map-index"
             data-restaurants-names="{{ restaurants_names }}"
             data-favicon-url="{% static "favicon.ico" %}"
             data-mapbox-access-token="{{ MAPBOX_ACCESS_TOKEN }}"
             data-restaurants-addresses="{{ restaurants_addresses }}"
             data-restaurants-indexes="{{ restaurants_indexes }}"></div>
        <script src="{% static "map_index.js" %}"></script>
      </div>
    </div>
  </body>
{% endblock %}
